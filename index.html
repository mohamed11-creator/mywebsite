<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BusinessLinks</title>
<style>
body { margin:0; padding:0; font-family:Impact, Charcoal, sans-serif; background:white; color:black; }
#splash { position:fixed; top:0; left:0; width:100%; height:100%; display:flex; justify-content:center; align-items:center; font-size:10vw; font-weight:bold; background:white; z-index:1000; opacity:0; transition:opacity 1s; }
#gallery { display:none; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap:20px; padding:20px; max-width:1200px; margin:auto; }
.slot { background:#f0f0f0; border-radius:10px; overflow:hidden; display:flex; flex-direction:column; align-items:center; }
.slot img { width:100%; aspect-ratio:9/16; object-fit:cover; border-bottom:1px solid #ccc; background:#ddd; }
.slot input[type="file"], .slot input[type="text"], .slot button { margin:5px 0; width:90%; padding:5px; font-size:0.9em; }
.slot input[type="text"] { border:1px solid #ccc; border-radius:5px; }
.slot button { background-color:#007BFF; color:white; border:none; border-radius:5px; cursor:pointer; }
.slot button:hover { background-color:#0056b3; }
</style>
</head>
<body>

<div id="splash">BusinessLinks</div>
<div id="gallery"></div>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
const splash = document.getElementById('splash');
const gallery = document.getElementById('gallery');

// Splash fade in/out
window.addEventListener('load', () => {
    splash.style.opacity = 1;
    setTimeout(() => {
        splash.style.opacity = 0;
        setTimeout(() => {
            splash.style.display = 'none';
            gallery.style.display = 'grid';
            createSlots();
            loadCloudinaryImages();
        }, 1000);
    }, 4000);
});

// Cloudinary configuration
const cloudName = 'dsaxcy1sm';
const unsignedUploadPreset = 'zrx3ywf6';
const folderName = 'businesslinks'; // optional: your folder name in Cloudinary

function createSlots() {
    gallery.innerHTML = '';
    for(let i=0; i<24; i++){
        const slot = document.createElement('div');
        slot.className = 'slot';

        const img = document.createElement('img');
        img.alt = `Slot ${i+1}`;
        slot.appendChild(img);

        const linkInput = document.createElement('input');
        linkInput.type = 'text';
        linkInput.placeholder = 'Enter link for this image';
        slot.appendChild(linkInput);

        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.accept = 'image/*';
        fileInput.addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if(!file) return;
            const link = linkInput.value || '';
            const uploaded = await uploadToCloudinary(file, link);
            if(uploaded) img.src = uploaded.secure_url;
        });
        slot.appendChild(fileInput);

        const removeBtn = document.createElement('button');
        removeBtn.textContent = 'Remove';
        removeBtn.addEventListener('click', () => {
            img.src = '';
            linkInput.value = '';
            fileInput.value = '';
        });
        slot.appendChild(removeBtn);

        gallery.appendChild(slot);
    }
}

// Upload image to Cloudinary
async function uploadToCloudinary(file, link) {
    const formData = new FormData();
    formData.append('file', file);
    formData.append('upload_preset', unsignedUploadPreset);
    formData.append('context', `link=${link}`);
    if(folderName) formData.append('folder', folderName);
    try {
        const res = await axios.post(`https://api.cloudinary.com/v1_1/${cloudName}/upload`, formData);
        return res.data;
    } catch(err) {
        alert('Upload failed');
        console.error(err);
        return null;
    }
}

// Load existing images from Cloudinary
async function loadCloudinaryImages() {
    try {
        // Replace with your Cloudinary JSON endpoint if using unsigned list
        const res = await axios.get(`https://res.cloudinary.com/${cloudName}/image/list/${folderName}.json`);
        const images = res.data.resources;
        const slots = document.querySelectorAll('.slot');

        images.forEach((imgData, index) => {
            if(index >= 24) return;
            const slot = slots[index];
            const img = slot.querySelector('img');
            const linkInput = slot.querySelector('input[type="text"]');
            img.src = imgData.url;
            if(imgData.context && imgData.context.custom && imgData.context.custom.link){
                linkInput.value = imgData.context.custom.link;
            }
        });
    } catch(err) {
        console.warn('Could not load existing Cloudinary images', err);
    }
}
</script>

</body>
</html>
